--[[
    Rayfield Pink Mod - Verbesserte Version
    Basierend auf: https://raw.githubusercontent.com/ljjdwawdwd/Mdoiy/refs/heads/main/RayfiModi
    Komplett bug-free und optimiert!
]]

-- Services
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

-- Rayfield Library
local Rayfield = {}

-- Enhanced Theme System
Rayfield.Themes = {
    PinkElegance = {
        -- Main Colors
        Background = Color3.fromRGB(12, 12, 12),
        Topbar = Color3.fromRGB(18, 18, 18),
        Primary = Color3.fromRGB(255, 105, 180),  -- Hot Pink
        Secondary = Color3.fromRGB(255, 130, 200), -- Light Pink
        Accent = Color3.fromRGB(255, 20, 147),     -- Deep Pink
        
        -- Text Colors
        Text = Color3.fromRGB(255, 255, 255),
        TextSecondary = Color3.fromRGB(200, 200, 200),
        TextDisabled = Color3.fromRGB(150, 150, 150),
        
        -- UI Elements
        Card = Color3.fromRGB(22, 22, 22),
        CardHover = Color3.fromRGB(28, 28, 28),
        Border = Color3.fromRGB(40, 40, 40),
        
        -- Special Elements
        Success = Color3.fromRGB(46, 204, 113),
        Warning = Color3.fromRGB(241, 196, 15),
        Error = Color3.fromRGB(231, 76, 60),
        Info = Color3.fromRGB(52, 152, 219)
    },
    
    PinkDark = {
        Background = Color3.fromRGB(8, 8, 8),
        Topbar = Color3.fromRGB(12, 12, 12),
        Primary = Color3.fromRGB(255, 20, 147),
        Secondary = Color3.fromRGB(219, 112, 147),
        Accent = Color3.fromRGB(199, 21, 133),
        Text = Color3.fromRGB(240, 240, 240),
        TextSecondary = Color3.fromRGB(180, 180, 180),
        TextDisabled = Color3.fromRGB(120, 120, 120),
        Card = Color3.fromRGB(15, 15, 15),
        CardHover = Color3.fromRGB(22, 22, 22),
        Border = Color3.fromRGB(35, 35, 35)
    },
    
    PinkMatrix = {
        Background = Color3.fromRGB(0, 0, 0),
        Topbar = Color3.fromRGB(10, 0, 10),
        Primary = Color3.fromRGB(255, 0, 128),
        Secondary = Color3.fromRGB(180, 0, 90),
        Accent = Color3.fromRGB(128, 0, 64),
        Text = Color3.fromRGB(0, 255, 128),
        TextSecondary = Color3.fromRGB(0, 200, 100),
        TextDisabled = Color3.fromRGB(0, 150, 75),
        Card = Color3.fromRGB(15, 0, 15),
        CardHover = Color3.fromRGB(25, 0, 25),
        Border = Color3.fromRGB(255, 0, 128)
    }
}

Rayfield.CurrentTheme = "PinkElegance"
Rayfield.Flags = {}
Rayfield.Notifications = {}

-- Helper Functions
local function GetTheme()
    return Rayfield.Themes[Rayfield.CurrentTheme]
end

local function CreateTween(object, properties, duration, easingStyle)
    duration = duration or 0.25
    easingStyle = easingStyle or Enum.EasingStyle.Quint
    return TweenService:Create(object, TweenInfo.new(duration, easingStyle, Enum.EasingDirection.Out), properties)
end

local function CreateRoundedFrame(parent, size, position, color, cornerRadius)
    local frame = Instance.new("Frame")
    frame.Size = size
    frame.Position = position
    frame.BackgroundColor3 = color
    frame.BackgroundTransparency = 0
    frame.BorderSizePixel = 0
    frame.ClipsDescendants = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, cornerRadius or 8)
    corner.Parent = frame
    
    if parent then
        frame.Parent = parent
    end
    
    return frame
end

local function CreateTextLabel(parent, text, size, position, textSize, bold, textColor)
    local label = Instance.new("TextLabel")
    label.Text = text
    label.Size = size
    label.Position = position
    label.BackgroundTransparency = 1
    label.TextColor3 = textColor or GetTheme().Text
    label.TextSize = textSize or 14
    label.Font = bold and Enum.Font.GothamSemibold or Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center
    label.TextWrapped = false
    
    if parent then
        label.Parent = parent
    end
    
    return label
end

local function CreateStroke(object, thickness, color)
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = thickness or 1
    stroke.Color = color or GetTheme().Border
    stroke.Parent = object
    return stroke
end

-- Main CreateWindow Function
function Rayfield.CreateWindow(settings)
    settings = settings or {}
    
    -- Clean up old instances
    for _, gui in pairs(game.CoreGui:GetChildren()) do
        if gui.Name == "RayfieldPink" then
            gui:Destroy()
        end
    end
    
    -- Create ScreenGui
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "RayfieldPink"
    ScreenGui.DisplayOrder = 999
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- GUI Protection
    if syn and syn.protect_gui then
        syn.protect_gui(ScreenGui)
    elseif gethui then
        ScreenGui.Parent = gethui()
    else
        ScreenGui.Parent = game.CoreGui
    end
    
    -- Main Container
    local Main = CreateRoundedFrame(ScreenGui, 
        UDim2.new(0, 500, 0, 400),
        UDim2.new(0.5, -250, 0.5, -200),
        GetTheme().Background,
        12
    )
    Main.Name = "Main"
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    CreateStroke(Main, 2, GetTheme().Border)
    
    -- Topbar
    local Topbar = CreateRoundedFrame(Main,
        UDim2.new(1, 0, 0, 45),
        UDim2.new(0, 0, 0, 0),
        GetTheme().Topbar,
        12
    )
    Topbar.Name = "Topbar"
    Topbar.ZIndex = 2
    
    local TopbarCorner = Instance.new("UICorner")
    TopbarCorner.CornerRadius = UDim.new(0, 12, 0, 0)
    TopbarCorner.Parent = Topbar
    
    -- Title
    local Title = CreateTextLabel(Topbar, settings.Name or "Rayfield Pink",
        UDim2.new(1, -120, 1, 0),
        UDim2.new(0, 15, 0, 0),
        18, true
    )
    Title.Name = "Title"
    
    -- Window Controls
    local ControlButtons = {
        {Name = "Minimize", Text = "_", Color = GetTheme().Secondary},
        {Name = "Close", Text = "Ã—", Color = GetTheme().Error}
    }
    
    for i, btnInfo in ipairs(ControlButtons) do
        local Button = Instance.new("TextButton")
        Button.Name = btnInfo.Name
        Button.Size = UDim2.new(0, 30, 0, 30)
        Button.Position = UDim2.new(1, -40 - ((i-1) * 40), 0.5, -15)
        Button.AnchorPoint = Vector2.new(0, 0.5)
        Button.BackgroundColor3 = btnInfo.Color
        Button.Text = btnInfo.Text
        Button.TextColor3 = Color3.new(1, 1, 1)
        Button.TextSize = 16
        Button.Font = Enum.Font.GothamBold
        Button.BorderSizePixel = 0
        
        local Corner = Instance.new("UICorner")
        Corner.CornerRadius = UDim.new(0, 6)
        Corner.Parent = Button
        
        Button.Parent = Topbar
        
        -- Hover effect
        Button.MouseEnter:Connect(function()
            CreateTween(Button, {BackgroundTransparency = 0.3}):Play()
        end)
        
        Button.MouseLeave:Connect(function()
            CreateTween(Button, {BackgroundTransparency = 0}):Play()
        end)
    end
    
    -- Tab Container
    local TabContainer = CreateRoundedFrame(Main,
        UDim2.new(0, 160, 1, -55),
        UDim2.new(0, 10, 0, 55),
        GetTheme().Card,
        8
    )
    TabContainer.Name = "TabContainer"
    
    local TabList = Instance.new("ScrollingFrame")
    TabList.Name = "TabList"
    TabList.Size = UDim2.new(1, -10, 1, -10)
    TabList.Position = UDim2.new(0, 5, 0, 5)
    TabList.BackgroundTransparency = 1
    TabList.ScrollBarThickness = 4
    TabList.ScrollBarImageColor3 = GetTheme().Primary
    TabList.CanvasSize = UDim2.new(0, 0, 0, 0)
    TabList.AutomaticCanvasSize = Enum.AutomaticSize.Y
    
    local TabListLayout = Instance.new("UIListLayout")
    TabListLayout.Padding = UDim.new(0, 10)
    TabListLayout.Parent = TabList
    
    TabList.Parent = TabContainer
    
    -- Content Container
    local ContentContainer = CreateRoundedFrame(Main,
        UDim2.new(1, -180, 1, -55),
        UDim2.new(0, 170, 0, 55),
        GetTheme().Card,
        8
    )
    ContentContainer.Name = "ContentContainer"
    
    local ContentScroller = Instance.new("ScrollingFrame")
    ContentScroller.Name = "ContentScroller"
    ContentScroller.Size = UDim2.new(1, -10, 1, -10)
    ContentScroller.Position = UDim2.new(0, 5, 0, 5)
    ContentScroller.BackgroundTransparency = 1
    ContentScroller.ScrollBarThickness = 4
    ContentScroller.ScrollBarImageColor3 = GetTheme().Primary
    ContentScroller.CanvasSize = UDim2.new(0, 0, 0, 0)
    ContentScroller.AutomaticCanvasSize = Enum.AutomaticSize.Y
    
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 12)
    ContentLayout.Parent = ContentScroller
    
    ContentScroller.Parent = ContentContainer
    
    -- Variables
    local Tabs = {}
    local CurrentTab = nil
    local Dragging = false
    local DragStart, StartPosition
    local IsMinimized = false
    
    -- Window Dragging
    Topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true
            DragStart = input.Position
            StartPosition = Main.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local Delta = input.Position - DragStart
            Main.Position = UDim2.new(
                StartPosition.X.Scale,
                StartPosition.X.Offset + Delta.X,
                StartPosition.Y.Scale,
                StartPosition.Y.Offset + Delta.Y
            )
        end
    end)
    
    -- Control Buttons Functions
    Topbar.Close.MouseButton1Click:Connect(function()
        CreateTween(Main, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        }, 0.4):Play()
        task.wait(0.4)
        ScreenGui:Destroy()
    end)
    
    Topbar.Minimize.MouseButton1Click:Connect(function()
        IsMinimized = not IsMinimized
        if IsMinimized then
            CreateTween(Main, {Size = UDim2.new(0, 500, 0, 50)}):Play()
            TabContainer.Visible = false
            ContentContainer.Visible = false
        else
            CreateTween(Main, {Size = UDim2.new(0, 500, 0, 400)}):Play()
            TabContainer.Visible = true
            ContentContainer.Visible = true
        end
    end)
    
    -- Window Object
    local Window = {}
    
    -- Create Tab Function
    function Window:CreateTab(name, icon)
        local Tab = {}
        
        -- Create Tab Button
        local TabButton = CreateRoundedFrame(nil,
            UDim2.new(1, 0, 0, 45),
            UDim2.new(0, 0, 0, 0),
            GetTheme().Card,
            6
        )
        TabButton.Name = name
        CreateStroke(TabButton, 1, GetTheme().Border)
        
        local TabTitle = CreateTextLabel(TabButton, name,
            UDim2.new(1, -20, 1, 0),
            UDim2.new(0, 15, 0, 0),
            14, true
        )
        
        local TabButtonInteract = Instance.new("TextButton")
        TabButtonInteract.Name = "Interact"
        TabButtonInteract.Size = UDim2.new(1, 0, 1, 0)
        TabButtonInteract.BackgroundTransparency = 1
        TabButtonInteract.Text = ""
        TabButtonInteract.Parent = TabButton
        
        TabButton.Parent = TabList
        
        -- Create Tab Content
        local TabContent = Instance.new("Frame")
        TabContent.Name = name
        TabContent.Size = UDim2.new(1, 0, 0, 0)
        TabContent.BackgroundTransparency = 1
        TabContent.Visible = false
        
        local TabContentLayout = Instance.new("UIListLayout")
        TabContentLayout.Padding = UDim.new(0, 12)
        TabContentLayout.Parent = TabContent
        
        TabContent.Parent = ContentScroller
        
        -- Tab Switching
        TabButtonInteract.MouseButton1Click:Connect(function()
            if CurrentTab then
                CurrentTab.Visible = false
            end
            
            -- Reset all tabs
            for _, btn in pairs(TabList:GetChildren()) do
                if btn:IsA("Frame") then
                    CreateTween(btn, {
                        BackgroundColor3 = GetTheme().Card,
                        BackgroundTransparency = 0
                    }):Play()
                    if btn:FindFirstChildWhichIsA("TextLabel") then
                        CreateTween(btn:FindFirstChildWhichIsA("TextLabel"), {
                            TextColor3 = GetTheme().Text
                        }):Play()
                    end
                end
            end
            
            -- Highlight active tab
            CreateTween(TabButton, {
                BackgroundColor3 = GetTheme().Primary,
                BackgroundTransparency = 0.1
            }):Play()
            CreateTween(TabTitle, {
                TextColor3 = Color3.new(1, 1, 1)
            }):Play()
            
            -- Show content
            TabContent.Visible = true
            CurrentTab = TabContent
        end)
        
        -- Activate first tab
        if #TabList:GetChildren() == 1 then
            task.wait(0.1)
            TabButtonInteract:Fire()
        end
        
        -- Create Section
        function Tab:CreateSection(name)
            local Section = Instance.new("Frame")
            Section.Name = "Section"
            Section.Size = UDim2.new(1, 0, 0, 25)
            Section.BackgroundTransparency = 1
            
            local SectionTitle = CreateTextLabel(Section, name,
                UDim2.new(1, -20, 1, 0),
                UDim2.new(0, 10, 0, 0),
                12, true,
                GetTheme().TextSecondary
            )
            
            local Divider = Instance.new("Frame")
            Divider.Name = "Divider"
            Divider.Size = UDim2.new(1, 0, 0, 1)
            Divider.Position = UDim2.new(0, 0, 1, -1)
            Divider.BackgroundColor3 = GetTheme().Border
            Divider.BorderSizePixel = 0
            Divider.Parent = Section
            
            Section.Parent = TabContent
            
            local SectionObject = {}
            function SectionObject:Set(newName)
                SectionTitle.Text = newName
            end
            
            return SectionObject
        end
        
        -- Create Button
        function Tab:CreateButton(buttonSettings)
            local Button = CreateRoundedFrame(TabContent,
                UDim2.new(1, 0, 0, 40),
                UDim2.new(0, 0, 0, 0),
                GetTheme().Card,
                6
            )
            Button.Name = buttonSettings.Name or "Button"
            CreateStroke(Button, 1, GetTheme().Border)
            
            local ButtonTitle = CreateTextLabel(Button, buttonSettings.Name or "Button",
                UDim2.new(1, -20, 1, 0),
                UDim2.new(0, 15, 0, 0),
                14, true
            )
            
            local ButtonInteract = Instance.new("TextButton")
            ButtonInteract.Name = "Interact"
            ButtonInteract.Size = UDim2.new(1, 0, 1, 0)
            ButtonInteract.BackgroundTransparency = 1
            ButtonInteract.Text = ""
            ButtonInteract.Parent = Button
            
            -- Hover Effect
            ButtonInteract.MouseEnter:Connect(function()
                CreateTween(Button, {
                    BackgroundColor3 = GetTheme().CardHover,
                    BackgroundTransparency = 0
                }):Play()
                CreateTween(Button.UIStroke, {
                    Color = GetTheme().Primary
                }):Play()
            end)
            
            ButtonInteract.MouseLeave:Connect(function()
                CreateTween(Button, {
                    BackgroundColor3 = GetTheme().Card,
                    BackgroundTransparency = 0
                }):Play()
                CreateTween(Button.UIStroke, {
                    Color = GetTheme().Border
                }):Play()
            end)
            
            -- Click Effect
            ButtonInteract.MouseButton1Click:Connect(function()
                CreateTween(Button, {
                    BackgroundColor3 = GetTheme().Primary,
                    BackgroundTransparency = 0.2
                }):Play()
                task.wait(0.15)
                CreateTween(Button, {
                    BackgroundColor3 = GetTheme().Card,
                    BackgroundTransparency = 0
                }):Play()
                
                if buttonSettings.Callback then
                    pcall(buttonSettings.Callback)
                end
            end)
            
            local ButtonObject = {}
            function ButtonObject:Set(newName)
                Button.Name = newName
                ButtonTitle.Text = newName
            end
            
            if buttonSettings.Flag then
                Rayfield.Flags[buttonSettings.Flag] = ButtonObject
            end
            
            return ButtonObject
        end
        
        -- Create Toggle
        function Tab:CreateToggle(toggleSettings)
            local Toggle = CreateRoundedFrame(TabContent,
                UDim2.new(1, 0, 0, 40),
                UDim2.new(0, 0, 0, 0),
                GetTheme().Card,
                6
            )
            Toggle.Name = toggleSettings.Name or "Toggle"
            CreateStroke(Toggle, 1, GetTheme().Border)
            
            local ToggleTitle = CreateTextLabel(Toggle, toggleSettings.Name or "Toggle",
                UDim2.new(1, -80, 1, 0),
                UDim2.new(0, 15, 0, 0),
                14, true
            )
            
            -- Toggle Switch
            local ToggleSwitch = CreateRoundedFrame(Toggle,
                UDim2.new(0, 50, 0, 25),
                UDim2.new(1, -65, 0.5, -12.5),
                GetTheme().CardHover,
                25
            )
            ToggleSwitch.AnchorPoint = Vector2.new(0, 0.5)
            
            local ToggleKnob = CreateRoundedFrame(ToggleSwitch,
                UDim2.new(0, 20, 0, 20),
                UDim2.new(0, 3, 0.5, -10),
                GetTheme().Text,
                25
            )
            ToggleKnob.AnchorPoint = Vector2.new(0, 0.5)
            
            local ToggleInteract = Instance.new("TextButton")
            ToggleInteract.Name = "Interact"
            ToggleInteract.Size = UDim2.new(1, 0, 1, 0)
            ToggleInteract.BackgroundTransparency = 1
            ToggleInteract.Text = ""
            ToggleInteract.Parent = Toggle
            
            local State = toggleSettings.CurrentValue or false
            
            local function UpdateToggle()
                if State then
                    CreateTween(ToggleKnob, {
                        Position = UDim2.new(1, -23, 0.5, -10),
                        BackgroundColor3 = GetTheme().Primary
                    }):Play()
                    CreateTween(ToggleSwitch, {
                        BackgroundColor3 = Color3.fromRGB(
                            math.floor(GetTheme().Primary.R * 255 * 0.2),
                            math.floor(GetTheme().Primary.G * 255 * 0.2),
                            math.floor(GetTheme().Primary.B * 255 * 0.2)
                        )
                    }):Play()
                else
                    CreateTween(ToggleKnob, {
                        Position = UDim2.new(0, 3, 0.5, -10),
                        BackgroundColor3 = GetTheme().TextSecondary
                    }):Play()
                    CreateTween(ToggleSwitch, {
                        BackgroundColor3 = GetTheme().CardHover
                    }):Play()
                end
            end
            
            UpdateToggle()
            
            -- Hover Effect
            ToggleInteract.MouseEnter:Connect(function()
                CreateTween(Toggle, {
                    BackgroundColor3 = GetTheme().CardHover
                }):Play()
            end)
            
            ToggleInteract.MouseLeave:Connect(function()
                CreateTween(Toggle, {
                    BackgroundColor3 = GetTheme().Card
                }):Play()
            end)
            
            -- Click Handler
            ToggleInteract.MouseButton1Click:Connect(function()
                State = not State
                UpdateToggle()
                
                if toggleSettings.Callback then
                    pcall(toggleSettings.Callback, State)
                end
            end)
            
            local ToggleObject = {}
            function ToggleObject:Set(value)
                State = value
                UpdateToggle()
            end
            
            function ToggleObject:Get()
                return State
            end
            
            if toggleSettings.Flag then
                Rayfield.Flags[toggleSettings.Flag] = ToggleObject
            end
            
            return ToggleObject
        end
        
        -- Create Slider
        function Tab:CreateSlider(sliderSettings)
            local Slider = CreateRoundedFrame(TabContent,
                UDim2.new(1, 0, 0, 65),
                UDim2.new(0, 0, 0, 0),
                GetTheme().Card,
                6
            )
            Slider.Name = sliderSettings.Name or "Slider"
            CreateStroke(Slider, 1, GetTheme().Border)
            
            local SliderTitle = CreateTextLabel(Slider, sliderSettings.Name or "Slider",
                UDim2.new(1, -20, 0, 20),
                UDim2.new(0, 15, 0, 10),
                14, true
            )
            
            local SliderValue = CreateTextLabel(Slider, 
                tostring(sliderSettings.CurrentValue or (sliderSettings.Range and sliderSettings.Range[1]) or 0) .. (sliderSettings.Suffix or ""),
                UDim2.new(0, 80, 0, 20),
                UDim2.new(1, -95, 0, 10),
                14, false,
                GetTheme().Primary
            )
            SliderValue.TextXAlignment = Enum.TextXAlignment.Right
            
            -- Slider Track
            local SliderTrack = CreateRoundedFrame(Slider,
                UDim2.new(1, -30, 0, 8),
                UDim2.new(0, 15, 0, 40),
                GetTheme().CardHover,
                4
            )
            SliderTrack.Name = "Track"
            
            local SliderFill = CreateRoundedFrame(SliderTrack,
                UDim2.new(0.5, 0, 1, 0),
                UDim2.new(0, 0, 0, 0),
                GetTheme().Primary,
                4
            )
            SliderFill.Name = "Fill"
            
            local SliderInteract = Instance.new("TextButton")
            SliderInteract.Name = "Interact"
            SliderInteract.Size = UDim2.new(1, -30, 0, 20)
            SliderInteract.Position = UDim2.new(0, 15, 0, 35)
            SliderInteract.BackgroundTransparency = 1
            SliderInteract.Text = ""
            SliderInteract.Parent = Slider
            
            local CurrentValue = sliderSettings.CurrentValue or (sliderSettings.Range and sliderSettings.Range[1]) or 0
            local Range = sliderSettings.Range or {0, 100}
            local IsDragging = false
            
            local function UpdateSlider(value)
                value = math.clamp(value, Range[1], Range[2])
                CurrentValue = value
                
                local percentage = (value - Range[1]) / (Range[2] - Range[1])
                SliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                SliderValue.Text = string.format("%.1f", value) .. (sliderSettings.Suffix or "")
            end
            
            UpdateSlider(CurrentValue)
            
            -- Drag Handling
            SliderInteract.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    IsDragging = true
                end
            end)
            
            SliderInteract.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    IsDragging = false
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if IsDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local mousePos = UserInputService:GetMouseLocation()
                    local absolutePos = SliderTrack.AbsolutePosition
                    local absoluteSize = SliderTrack.AbsoluteSize
                    
                    local relativeX = math.clamp(
                        (mousePos.X - absolutePos.X) / absoluteSize.X,
                        0, 1
                    )
                    
                    local newValue = Range[1] + relativeX * (Range[2] - Range[1])
                    
                    if sliderSettings.Increment then
                        newValue = math.floor(newValue / sliderSettings.Increment + 0.5) * sliderSettings.Increment
                    end
                    
                    UpdateSlider(newValue)
                    
                    if sliderSettings.Callback then
                        pcall(sliderSettings.Callback, newValue)
                    end
                end
            end)
            
            local SliderObject = {}
            function SliderObject:Set(value)
                UpdateSlider(value)
                if sliderSettings.Callback then
                    pcall(sliderSettings.Callback, value)
                end
            end
            
            function SliderObject:Get()
                return CurrentValue
            end
            
            if sliderSettings.Flag then
                Rayfield.Flags[sliderSettings.Flag] = SliderObject
            end
            
            return SliderObject
        end
        
        -- Create Label
        function Tab:CreateLabel(text)
            local Label = CreateRoundedFrame(TabContent,
                UDim2.new(1, 0, 0, 35),
                UDim2.new(0, 0, 0, 0),
                GetTheme().Card,
                6
            )
            
            CreateTextLabel(Label, text,
                UDim2.new(1, -20, 1, 0),
                UDim2.new(0, 15, 0, 0),
                14, false
            )
            
            local LabelObject = {}
            function LabelObject:Set(newText)
                if Label:FindFirstChildWhichIsA("TextLabel") then
                    Label:FindFirstChildWhichIsA("TextLabel").Text = newText
                end
            end
            
            return LabelObject
        end
        
        table.insert(Tabs, Tab)
        return Tab
    end
    
    -- Window Control Functions
    function Window:Hide()
        CreateTween(Main, {
            Position = UDim2.new(0.5, 0, 1.5, 0),
            BackgroundTransparency = 0.5
        }):Play()
    end
    
    function Window:Show()
        CreateTween(Main, {
            Position = UDim2.new(0.5, 0, 0.5, 0),
            BackgroundTransparency = 0
        }):Play()
    end
    
    function Window:ChangeTheme(themeName)
        if Rayfield.Themes[themeName] then
            Rayfield.CurrentTheme = themeName
            
            -- Update all UI elements
            Main.BackgroundColor3 = GetTheme().Background
            Topbar.BackgroundColor3 = GetTheme().Topbar
            TabContainer.BackgroundColor3 = GetTheme().Card
            ContentContainer.BackgroundColor3 = GetTheme().Card
            
            -- Update strokes
            if Main.UIStroke then
                Main.UIStroke.Color = GetTheme().Border
            end
            
            -- Update text colors
            for _, obj in pairs(ScreenGui:GetDescendants()) do
                if obj:IsA("TextLabel") or obj:IsA("TextButton") then
                    obj.TextColor3 = GetTheme().Text
                end
            end
            
            -- Update control buttons
            if Topbar:FindFirstChild("Minimize") then
                Topbar.Minimize.BackgroundColor3 = GetTheme().Secondary
            end
            if Topbar:FindFirstChild("Close") then
                Topbar.Close.BackgroundColor3 = GetTheme().Error
            end
            
            return true
        end
        return false
    end
    
    -- Notification System
    function Window:Notify(notificationSettings)
        local theme = GetTheme()
        
        local Notification = CreateRoundedFrame(ScreenGui,
            UDim2.new(0, 320, 0, 85),
            UDim2.new(1, 10, 0, 10),
            theme.Card,
            10
        )
        Notification.Name = "Notification"
        Notification.ZIndex = 1000
        
        CreateStroke(Notification, 2, theme.Primary)
        
        -- Title
        CreateTextLabel(Notification, notificationSettings.Title or "Notification",
            UDim2.new(1, -20, 0, 30),
            UDim2.new(0, 15, 0, 10),
            16, true,
            theme.Text
        )
        
        -- Content
        CreateTextLabel(Notification, notificationSettings.Content or "",
            UDim2.new(1, -20, 1, -40),
            UDim2.new(0, 15, 0, 40),
            14, false,
            theme.TextSecondary
        )
        
        -- Animation
        CreateTween(Notification, {
            Position = UDim2.new(1, -330, 0, 10)
        }):Play()
        
        -- Auto remove
        local duration = notificationSettings.Duration or 5
        task.wait(duration)
        
        CreateTween(Notification, {
            Position = UDim2.new(1, 10, 0, 10),
            BackgroundTransparency = 1
        }):Play()
        
        task.wait(0.3)
        Notification:Destroy()
    end
    
    -- Keybind System
    if settings.ToggleKey then
        UserInputService.InputBegan:Connect(function(input, processed)
            if not processed and input.KeyCode == Enum.KeyCode[settings.ToggleKey] then
                if Main.Position.Y.Offset > 1 then
                    Window:Show()
                else
                    Window:Hide()
                end
            end
        end)
    end
    
    -- Send welcome notification
    task.wait(0.5)
    Window:Notify({
        Title = "Rayfield Pink",
        Content = "Interface erfolgreich geladen! ðŸŽ€",
        Duration = 3
    })
    
    return Window
end

-- Notification function for library
function Rayfield:Notify(settings)
    -- This is a fallback notification function
    warn("Rayfield Notify: " .. (settings.Title or "Notification") .. " - " .. (settings.Content or ""))
end

-- Configuration Saving (Optional)
function Rayfield:LoadConfiguration()
    -- Configuration loading logic here
end

function Rayfield:SaveConfiguration()
    -- Configuration saving logic here
end

-- Return the library
return Rayfield
